groups:
- name: node-systemd
  rules:
{%- for item in prometheus_rules_node_systemd.elements %}

  - alert: {{ item.type|title }}{{ item.name|title }}NotRunning
    expr: node_systemd_unit_state{name="{{ item.name }}.{{ item.type }}", state="active"} == 0
    for: {{ prometheus_rules_node_systemd.timeframe }}
    labels:
      service: {{ item.name }}
      severity: critical
    annotations:
      description: "{{ item.type|title }} {{ item.name }} at {{ '{{' }} $labels.instance {{ '}}' }} not running for over {{ prometheus_rules_node_systemd.timeframe }}"
      title: "{{ item.type|title }} {{ item.name }} is not running"

{% endfor %}
